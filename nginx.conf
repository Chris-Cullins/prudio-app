location / {
    try_files $uri $uri/ /public/index.php?$query_string;
}

if (!-d $request_filename) {
    rewrite     ^/(.+)/$ /public/$1 permanent;
}

location ~ /\.ht {
    deny all;
}